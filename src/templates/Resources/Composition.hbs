{
    "fullUrl":"urn:uuid:{{ID}}",
    "resource":{
        "resourceType": "Composition",
        "id":"{{ID}}",
        "identifier":
  		{
  			"use":"official",
			"value":"{{composition.id.root}}",
        },
		"status":"preliminary",
        "type":
		[
        	{{#each (toArray composition.code)}}
        		{{>DataType/Coding.hbs code=this}},
           	{{/each}}
        ],
        "date":"{{formatAsDateTime composition.effectiveTime.value}}"
        "title":"{{composition.title._}}"
        "attester": 
        [
        	{
        		"mode": ["legal"],
            	"time":"{{formatAsDateTime composition.legalAuthenticator.time.value}}"
			}
        ],
        "event":
        [
           	{
                "period":
           		{
                   	"start":"{{formatAsDateTime composition.documentationOf.serviceEvent.effectiveTime.low.value}}"
                },
                "detail":
               	[
               		{{#each composition.documentationOf.serviceEvent.performer}}
                 		{
                            "reference":"{{concat 'Practitioner/' (generateUUID (toJsonString this))}}",
                  			"display":"{{this.assignedEntity.assignedPerson.name.given._}} {{this.assignedEntity.assignedPerson.name.family._}}"
                        },
               		{{/each}}         
           		],
           	},
        ],
		"section": 
        [               
            {{#each composition.component.structuredBody.component}}
               	{
                	"title":"{{this.section.title._}}",
                   	"title":"{{this.section.code.displayName}}",         
                    "code":{{>DataType/CodeableConcept.hbs code=this.section.code}},
                    "mode":"snapshot",
                    "entry":
                    [
                        {{#with (evaluate 'Utils/ResourceTypeFromSection.hbs' section=this.section) as |resObj|}}
                            {{#if (and (eq resObj.resourceType 'Observation') (contains (toJsonString ../this.section.templateId) '2.16.840.1.113883.10.20.22.2.4.1'))}}
                                {{#each (toArray ../this.section.entry)}}
                                    {{#each (toArray this.organizer.component)}}                           	
                                        {
                                            "reference":"{{concat resObj.resourceType '/' (generateUUID (toJsonString this))}}",
                                            {{>Utils/DisplayFromSectionEntry.hbs section=../../../this.section entry=this}}
                                        },
                                    {{/each}}
                                {{/each}}
                            {{else if resObj.resourceType}}
                                {{#each ../this.section.entry}}                           	
                                    {
                                        "reference":"{{concat resObj.resourceType '/' (generateUUID (toJsonString this))}}",
                                        {{>Utils/DisplayFromSectionEntry.hbs section=../../this.section entry=this}}
                                    },
                                {{/each}}
                            {{/if}}
                        {{/with}}
                    ]
                },
            {{/each}}
        ]
    },
    "request":{
        "method":"POST",
        "url":"Composition",
    },
},

